$(function(){var methods;return methods={init:function(options){var def,_this;return null==options&&(options={}),def={content:{},geo:{lat:"",lon:"",city:"",region:"",country:""},result:{key:""}},$.extend(!0,def,options),$(this).data("sn",def),_this=this,$(this).snDemand("geoIp"),$("#demand-name").live("keyup",function(){return $(_this).snDemand("checkName",$(this).val())}),$("#demand-phone").live("keyup",function(){return $(_this).snDemand("checkPhone",$(this).val())}),$("#demand-company").live("keyup",function(){return $(_this).snDemand("checkCompany",$(this).val())}),$("#demand-comment").live("keyup",function(){return $(_this).snDemand("checkComment",$(this).val())}),$("#push-demand").live("click",function(){return $("#wall-demand").show().css({width:$(document).width(),height:$(document).height()}),$("#modal-demand").show()}),$(".modal-header a.close").live("click",function(){return $("#wall-demand").hide(),$("#modal-demand").hide()}),$("#modal-close").live("click",function(){return $("#wall-demand").hide(),$("#modal-demand").hide()}),$("#modal-send").live("click",function(){return $(this).snDemand("check")?($(".demand-success p").show(),$(".demand-error p").hide(),$("#modal-send").hide(),$(_this).snDemand("send")):($(".demand-success p").hide(),$(".demand-error p").show())})},send:function(){var sn;return sn=$(this).data("sn"),$(this).snDemand("addToBase"),$(this).snDemand("addToGit")},geoIp:function(){var sn,_this;return _this=this,sn=$(this).data("sn"),$.ajax({url:"http://j.maxmind.com/app/geoip.js",dataType:"script",timeout:5e3,success:function(){return sn.geo={lat:geoip_latitude(),lon:geoip_longitude(),city:geoip_city(),region:geoip_region(),country:geoip_country_name()},$(_this).data("sn",sn)}})},addToBase:function(){var dp,sector,sn;return sn=$(this).data("sn"),dp=$('[name="demand-type"]:checked').val(),sector=$('[name="demand-type-'+dp+'"]').val(),$.ajax({url:"http://www.standart-n.ru/external/ajax_claim.php",type:"GET",data:{act:"add",name:$("#demand-name").val(),tel:$("#demand-phone").val(),email:$("#demand-email").val(),comment:$("#demand-comment").val(),company:$("#demand-company").val(),department:sector,skype:"",icq:"",site:"",lat:sn.geo.lat,lon:sn.geo.lon,city:sn.geo.city,region:sn.geo.region,country:sn.geo.country},dataType:"text",timeout:5e3})},addToGit:function(){var dp,message,sector,sn;return sn=$(this).data("sn"),dp=$('[name="demand-type"]:checked').val(),sector=$('[name="demand-type-'+dp+'"]').val(),message=""+sector+" "+$("#demand-company").val()+" "+$("#demand-name").val()+" "+$("#demand-phone").val()+" "+$("#demand-email").val()+" "+$("#demand-comment").val()+" ",sn.geo.city+" "+$.ajax({url:"http://git.st-n.ru/",type:"GET",data:{action:"addClaim",msg:message},dataType:"text",timeout:1e3})},check:function(){var flag;return flag=!0,$(this).snDemand("checkName",$("#demand-name").val())||(flag=!1),$(this).snDemand("checkPhone",$("#demand-phone").val())||(flag=!1),$(this).snDemand("checkCompany",$("#demand-company").val())||(flag=!1),$(this).snDemand("checkComment",$("#demand-comment").val())||(flag=!1),flag},checkName:function(val){var flag;return null==val&&(val=""),flag=$(this).snDemand("flagName",val),flag?($("#validate-name .validate-true").show(),$("#validate-name .validate-false").hide()):($("#validate-name .validate-true").hide(),$("#validate-name .validate-false").show()),flag},checkCompany:function(val){var flag;return null==val&&(val=""),flag=$(this).snDemand("flagCompany",val),flag?($("#validate-company .validate-true").show(),$("#validate-company .validate-false").hide()):($("#validate-company .validate-true").hide(),$("#validate-company .validate-false").show()),flag},checkPhone:function(val){var flag;return null==val&&(val=""),flag=$(this).snDemand("flagPhone",val),flag?($("#validate-phone .validate-true").show(),$("#validate-phone .validate-false").hide()):($("#validate-phone .validate-true").hide(),$("#validate-phone .validate-false").show()),flag},checkComment:function(val){var flag;return null==val&&(val=""),flag=$(this).snDemand("flagComment",val),flag?($("#validate-comment .validate-true").show(),$("#validate-comment .validate-false").hide()):($("#validate-comment .validate-true").hide(),$("#validate-comment .validate-false").show()),flag},flagName:function(val){var flag;return null==val&&(val=""),flag=!0,""===val&&(flag=!1),(val.length<2||val.length>30)&&(flag=!1),/[^a-z0-9\.\,\"\?\!\;\:\#\$\%\&\(\)\*\+\-\/\<\>\=\@\[\]\\\^\_\{\}\|\~]+/i.test(val)||(flag=!1),flag},flagCompany:function(val){var flag;return null==val&&(val=""),flag=!0,""===val&&(flag=!1),(val.length<2||val.length>30)&&(flag=!1),flag},flagComment:function(val){var flag;return null==val&&(val=""),flag=!0,""===val&&(flag=!1),val.length<2&&(flag=!1),flag},flagPhone:function(val){var flag;return null==val&&(val=""),flag=!0,(""===val||"+7"===val)&&(flag=!1),(val.length<4||val.length>30)&&(flag=!1),/\+?\d{1,3}(?:\s*\(\d+\)\s*)?(?:(?:\-\d{1,3})+\d|[\d\-]{4,}|(?:\s\d{1,3})+\d)/i.test(val)||(flag=!1),flag}},$.fn.snDemand=function(sn){return null==sn&&(sn={}),methods[sn]?methods[sn].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof sn&&sn?$.error("Метод #{sn} не существует"):methods.init.apply(this,arguments)}});